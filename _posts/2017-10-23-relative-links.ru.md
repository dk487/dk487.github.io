---
title: Относительные ссылки
date: 2017-10-23 15:34:19 +0300
---
Есть одна тема в Jekyll'е, которая меня бесит. И эта тема — ссылки.

Я глубоко убеждён, что настоящий статический сайт должен использовать
относительные ссылки, причём не в том смысле, который разработчики
Jekyll'а используют в функции `relative_url`.

| Страница          | `relative_url`    | Правильный URL    |
|-------------------|-------------------|-------------------|
| /about.html       | /css/main.css     | css/main.css      |
| /news/page2.html  | /css/main.css     | ../css/main.css   |

Главный use case для таких ссылок — это «сайт на флешке», возможность
открыть сайт в браузере без веб-сервера из локальных файлов.

Чёрт возьми, да это же один из главных приколов статической сборки!

Также это даёт возможность хостить сайт в любом подкаталоге любого
другого сайта без пересборки с новым значением `baseurl`. Кому-то это
может показаться неважным, но только не мне.

Что можно сделать для получения таких относительных ссылок? Наверное,
можно использовать какой-то плагин. Не наша тема, потому что плагины
несовместимы с Github Pages. Но ещё можно обойтись средствами Liquid'а.

```liquid
{%      assign root_prefix = ''
%}{%    assign root_subfolders = page.url | split: '/' | size | minus: 2
%}{%    for x in (1..root_subfolders)
%}{%        assign root_prefix = root_prefix | append: '../'
%}{%    endfor
%}<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="{{ root_prefix }}css/main.css">
``` 

Выглядит коряво, но работает.
